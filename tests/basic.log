## ------------------------------------------- ##
## Open-COBOL-ESQL-1.2 test suite: basic test. ##
## ------------------------------------------- ##

basic: command line was:
  $ ./basic 

## --------- ##
## Platform. ##
## --------- ##

hostname = 4fbfcdbb678d
uname -m = x86_64
uname -r = 5.10.76-linuxkit
uname -s = Linux
uname -v = #1 SMP Mon Nov 8 10:21:19 UTC 2021

/usr/bin/uname -p = x86_64
/bin/uname -X     = unknown

/bin/arch              = x86_64
/usr/bin/arch -k       = unknown
/usr/convex/getsysinfo = unknown
/usr/bin/hostinfo      = unknown
/bin/machine           = unknown
/usr/bin/oslevel       = unknown
/bin/universe          = unknown

PATH: /usr/local/sbin
PATH: /usr/local/bin
PATH: /usr/sbin
PATH: /usr/bin
PATH: /sbin
PATH: /bin

basic: atlocal:
| COBC="cobc -locesql"
| OCESQL=ocesql
| EMBED_DB_INFO="sh ../../embed_db_info.sh"
| COMPILE="${COBC} -I ../../"
| COMPILE_MODULE="${COMPILE}"
| RUN_MODULE=cobcrun

## ---------------- ##
## Tested programs. ##
## ---------------- ##

/basic.at:1: /usr/bin/ocesql --version
Open Cobol ESQL (Ocesql)
Version 1.2.0

April 19, 2019

Tokyo System House Co., Ltd. <opencobol@tsh-world.co.jp>

## ------------------ ##
## Running the tests. ##
## ------------------ ##
basic: starting at: Thu Jan  6 06:20:50 UTC 2022
1. connect and disconnect statement test (connect-disconnect.at:1): ok     (0m0.101s 0m0.093s)
2. declare statement test (declare.at:1): ok     (0m0.132s 0m0.113s)
3. open and close statement test (open-close.at:1): ok     (0m0.111s 0m0.109s)
4. insert statement test (insert.at:1): ok     (0m0.133s 0m0.103s)
5. fetch statement test (fetch.at:1): ok     (0m0.164s 0m0.123s)
6. delete statement test (delete.at:1): ok     (0m0.170s 0m0.094s)
8. commit and rollback statement test (commit-rollback.at:1): ok     (0m0.158s 0m0.119s)
9. select statement test (select.at:1): ok     (0m0.131s 0m0.121s)
11. other sql test (other-sql.at:1): ok     (0m0.137s 0m0.105s)
basic: ending at: Thu Jan  6 06:21:00 UTC 2022
basic: test suite duration: 0h 0m 10s

## ------------- ##
## Test results. ##
## ------------- ##

ERROR: All 11 tests were run,
2 failed unexpectedly.

## ------------------------ ##
## Summary of the failures. ##
## ------------------------ ##
Failed tests:
Open-COBOL-ESQL-1.2 test suite: basic test test groups:

 NUM: FILE-NAME:LINE     TEST-GROUP-NAME
      KEYWORDS

   7: update.at:1        update statement test
  10: prepare-execute.at:1 prepare and execute statement test

## ---------------------- ##
## Detailed failed tests. ##
## ---------------------- ##

#                             -*- compilation -*-
7. update.at:1: testing update statement test ...
/update.at:185: ocesql prog.cbl prog.cob > /dev/null
/update.at:186: ${EMBED_DB_INFO} prog.cob
/update.at:187: ${COMPILE_MODULE} prog.cob
/update.at:188: ${RUN_MODULE} prog
--- -	2022-01-06 06:20:56.569851800 +0000
+++ /root/share/opensourcecobol/Open-COBOL-ESQL/tests/basic.dir/at-groups/7/stdout	2022-01-06 06:20:56.566997200 +0000
@@ -1,12 +1,12 @@
-0001 <log> success test_return_code
-0002 <log> success fetch_record +0001, Hokkai Taro         , +0400
-0003 <log> success fetch_record +0002, Aomori Jiro         , +0350
-0004 <log> success fetch_record +0003, Akita Saburo        , +0300
-0005 <log> success fetch_record +0004, Iwate Shiro         , -0250
-0006 <log> success fetch_record +0005, Miyagi Goro         , -0200
-0007 <log> success fetch_record +0006, NO_NAME             , +0150
-0008 <log> success fetch_record +0007, NO_NAME             , -0100
-0009 <log> success fetch_record +0008, NO_NAME             , +0050
-0010 <log> success fetch_record +0009, NO_NAME             , -0200
-0011 <log> success fetch_record +0010, NO_NAME             , +0350
+0001 <log> fail test_return_code    SQLCODE=-000000400 ERRCODE=25P02 Undefined_errorERROR:  current transaction is aborted, commands ignored until end of 
+0002 <log> success fetch_record +0001, 北海　太郎          , +0400
+0003 <log> success fetch_record +0002, 青森　次郎          , +0350
+0004 <log> success fetch_record +0003, 秋田　三郎          , +0300
+0005 <log> success fetch_record +0004, 岩手　四郎          , -0250
+0006 <log> success fetch_record +0005, 宮城　五郎          , -0200
+0007 <log> success fetch_record +0006, 福島　六郎          , +0150
+0008 <log> success fetch_record +0007, 栃木　七郎          , -0100
+0009 <log> success fetch_record +0008, 茨城　八郎          , +0050
+0010 <log> success fetch_record +0009, 群馬　九郎          , -0200
+0011 <log> success fetch_record +0010, 埼玉　十郎          , +0350
 
7. update.at:1: 7. update statement test (update.at:1): FAILED (update.at:188)

#                             -*- compilation -*-
10. prepare-execute.at:1: testing prepare and execute statement test ...
/prepare-execute.at:193: ocesql prog.cbl prog.cob > /dev/null
/prepare-execute.at:194: ${EMBED_DB_INFO} prog.cob
/prepare-execute.at:195: ${COMPILE_MODULE} prog.cob
/prepare-execute.at:205: ${RUN_MODULE} prog > result.txt
/prepare-execute.at:206: echo 1 0 
--- /dev/null	2022-01-06 06:10:48.614288000 +0000
+++ /root/share/opensourcecobol/Open-COBOL-ESQL/tests/basic.dir/at-groups/10/stdout	2022-01-06 06:20:59.159699700 +0000
@@ -0,0 +1 @@
+1 0
10. prepare-execute.at:1: 10. prepare and execute statement test (prepare-execute.at:1): FAILED (prepare-execute.at:206)


